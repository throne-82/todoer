<article class="group rounded-lg px-1 py-1">
  <div class="flex items-center gap-3">
    <button
      type="button"
      class="status-icon"
      [class]="'status-icon ' + statusClass()"
      (click)="cycleStatus()"
      title="Alterar status"
    ></button>

    @if (editing()) {
      <input
        type="text"
        class="flex-1 rounded-md border border-[var(--border-color)] bg-[var(--surface)] px-2 py-1 text-[var(--text-primary)] outline-none focus:border-sky-400"
        [ngModel]="draftTitle()"
        (ngModelChange)="draftTitle.set($event)"
        (keyup.enter)="saveEdit()"
        (keyup.escape)="cancelEdit()"
        (blur)="saveEdit()"
        autofocus
      />
    } @else {
      <button
        type="button"
        class="min-w-0 flex-1 truncate text-left text-[1.75rem] leading-[1.15]"
        [class.done-title]="isDone()"
        (click)="toggleExpanded()"
        (dblclick)="beginEdit()"
        title="Clique para detalhes / duplo clique para editar"
      >
        {{ task().title }}
      </button>
    }

    @if (showListTag()) {
      <span class="list-tag">
        <span class="list-dot" [style.backgroundColor]="listColor()"></span>
        {{ listName() }}
      </span>
    }

    @if (isImportant()) {
      <span class="important-flag" title="Importante">ğŸš©</span>
    }

    <button
      type="button"
      class="rounded-md px-2 py-1 text-xs text-red-500 opacity-0 transition group-hover:opacity-100 hover:bg-red-500/10"
      (click)="removeTask()"
      title="Excluir tarefa"
    >
      Del
    </button>
  </div>

  @if (expanded()) {
    <div class="task-details">
      <label class="details-label">DescriÃ§Ã£o</label>
      <textarea
        class="details-textarea"
        rows="2"
        [ngModel]="draftDescription()"
        (ngModelChange)="draftDescription.set($event)"
        (blur)="saveDetails()"
        placeholder="DescriÃ§Ã£o da tarefa..."
      ></textarea>

      <div class="details-row">
        <div class="details-time-wrap">
          <label class="details-label">HorÃ¡rio</label>
          <input
            type="time"
            class="details-time"
            [ngModel]="draftDueTime()"
            (ngModelChange)="draftDueTime.set($event)"
            (change)="saveDetails()"
          />
        </div>

        <button type="button" class="important-btn" (click)="toggleImportant()">
          {{ draftImportant() ? 'ğŸš© ImportantÃ£o' : 'âš Marcar importante' }}
        </button>
      </div>
    </div>
  }
</article>
